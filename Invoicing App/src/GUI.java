import java.io.IOException;
import java.nio.file.FileAlreadyExistsException;
import java.nio.file.Files;
import java.nio.file.Path;
import java.nio.file.StandardOpenOption;
import java.awt.Color;
import java.time.*;
import com.github.lgooddatepicker.components.DatePickerSettings;
import java.util.ArrayList;

/**
 *
 * @author CrispyBacon
 */
public class GUI extends javax.swing.JFrame {
private HelpArray help = new HelpArray();
private ArrayList<Client> clients = new ArrayList<Client>();
private int counter;

    /**
     * Creates new form GUI
     */
    public GUI() {
        initComponents();
        PythonExecuter.ExecutePython("CreateClientList");
        clients = Client.generateClientList();
        counter = clients.size();
        for(int i=0; i<counter; i++){
            cboClients.addItem(clients.get(i).getName());
        }
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        ifrMainMenu = new javax.swing.JInternalFrame();
        lblMenuPic = new javax.swing.JLabel();
        jMenuBar1 = new javax.swing.JMenuBar();
        mnuExit = new javax.swing.JMenu();
        mniExit = new javax.swing.JMenuItem();
        nmuClients = new javax.swing.JMenu();
        mniCreateInvoice = new javax.swing.JMenuItem();
        mniRegisterClient = new javax.swing.JMenuItem();
        pnlRegister = new javax.swing.JPanel();
        lblRegErrEmailAdd = new javax.swing.JLabel();
        lbRegSurName = new javax.swing.JLabel();
        txtRegEmailAdd = new javax.swing.JTextField();
        lblErrRegSurName = new javax.swing.JLabel();
        lblRegPhone = new javax.swing.JLabel();
        txtRegSurName = new javax.swing.JTextField();
        lblRegErrPhone = new javax.swing.JLabel();
        btnHelpReg = new javax.swing.JButton();
        lblRegister = new javax.swing.JLabel();
        txtRegPhone = new javax.swing.JTextField();
        btnRegRegister = new javax.swing.JButton();
        btnRegMainMenu = new javax.swing.JButton();
        lbRegiFirstName = new javax.swing.JLabel();
        lblErrRegFirstName = new javax.swing.JLabel();
        txtRegFirstName = new javax.swing.JTextField();
        lblRegEmailAdd = new javax.swing.JLabel();
        pnlCreateInvoice = new javax.swing.JPanel();
        lbInvoiceHeading = new javax.swing.JLabel();
        btnHelpCreateInv = new javax.swing.JButton();
        btnMainMenuCreateInv = new javax.swing.JButton();
        btnCreateInv = new javax.swing.JButton();
        lblSelectClient = new javax.swing.JLabel();
        cboClients = new javax.swing.JComboBox<>();
        lblErrClient = new javax.swing.JLabel();
        lblDOS = new javax.swing.JLabel();
        lblErrorDurSes = new javax.swing.JLabel();
        rdbIndividual = new javax.swing.JRadioButton();
        rdbGroup = new javax.swing.JRadioButton();
        lblErrHowMany = new javax.swing.JLabel();
        lblHowMany = new javax.swing.JLabel();
        lblAmount = new javax.swing.JLabel();
        txtfldAmount = new javax.swing.JTextField();
        lblErrAmount = new javax.swing.JLabel();
        lblGrpOrIndv1 = new javax.swing.JLabel();
        lblErrGrpOrIndv1 = new javax.swing.JLabel();
        cbonoPeople = new javax.swing.JComboBox<>();
        datePicker1 = new com.github.lgooddatepicker.components.DatePicker();
        lblDurOS = new javax.swing.JLabel();
        cbodurSes = new javax.swing.JComboBox<>();
        lblErrorDOS = new javax.swing.JLabel();

        setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);
        getContentPane().setLayout(new java.awt.CardLayout());

        ifrMainMenu.setVisible(true);

        lblMenuPic.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Images/sam cowen.jpeg"))); // NOI18N

        mnuExit.setText("Exit");

        mniExit.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Images/exit.png"))); // NOI18N
        mniExit.setText("exit");
        mniExit.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                mniExitActionPerformed(evt);
            }
        });
        mnuExit.add(mniExit);

        jMenuBar1.add(mnuExit);

        nmuClients.setText("Clients");

        mniCreateInvoice.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Images/job.png"))); // NOI18N
        mniCreateInvoice.setText("Create Invoice");
        mniCreateInvoice.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                mniCreateInvoiceActionPerformed(evt);
            }
        });
        nmuClients.add(mniCreateInvoice);

        mniRegisterClient.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Images/addemployee.png"))); // NOI18N
        mniRegisterClient.setText("Register Client");
        mniRegisterClient.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                mniRegisterClientActionPerformed(evt);
            }
        });
        nmuClients.add(mniRegisterClient);

        jMenuBar1.add(nmuClients);

        ifrMainMenu.setJMenuBar(jMenuBar1);

        javax.swing.GroupLayout ifrMainMenuLayout = new javax.swing.GroupLayout(ifrMainMenu.getContentPane());
        ifrMainMenu.getContentPane().setLayout(ifrMainMenuLayout);
        ifrMainMenuLayout.setHorizontalGroup(
            ifrMainMenuLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, ifrMainMenuLayout.createSequentialGroup()
                .addContainerGap()
                .addComponent(lblMenuPic, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addContainerGap())
        );
        ifrMainMenuLayout.setVerticalGroup(
            ifrMainMenuLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(ifrMainMenuLayout.createSequentialGroup()
                .addContainerGap()
                .addComponent(lblMenuPic, javax.swing.GroupLayout.DEFAULT_SIZE, 650, Short.MAX_VALUE))
        );

        getContentPane().add(ifrMainMenu, "card5");

        pnlRegister.setBackground(new java.awt.Color(255, 255, 255));
        pnlRegister.setForeground(new java.awt.Color(255, 255, 255));
        pnlRegister.setMaximumSize(new java.awt.Dimension(600, 600));
        pnlRegister.setMinimumSize(new java.awt.Dimension(600, 600));

        lblRegErrEmailAdd.setFont(new java.awt.Font("Times New Roman", 0, 15)); // NOI18N
        lblRegErrEmailAdd.setForeground(new java.awt.Color(255, 0, 0));

        lbRegSurName.setText("Surname:");
        lbRegSurName.setFont(new java.awt.Font("Times New Roman", 0, 18)); // NOI18N

        lblErrRegSurName.setFont(new java.awt.Font("Times New Roman", 0, 15)); // NOI18N
        lblErrRegSurName.setForeground(new java.awt.Color(255, 0, 0));

        lblRegPhone.setText("Phone Number:");
        lblRegPhone.setFont(new java.awt.Font("Times New Roman", 0, 18)); // NOI18N

        lblRegErrPhone.setFont(new java.awt.Font("Times New Roman", 0, 15)); // NOI18N
        lblRegErrPhone.setForeground(new java.awt.Color(255, 0, 0));

        btnHelpReg.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Images/Help.png"))); // NOI18N
        btnHelpReg.setText("Help");
        btnHelpReg.setBackground(new java.awt.Color(255, 255, 255));
        btnHelpReg.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnHelpRegActionPerformed(evt);
            }
        });

        lblRegister.setText("Register");
        lblRegister.setFont(new java.awt.Font("Times New Roman", 1, 18)); // NOI18N

        btnRegRegister.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Images/addemployee.png"))); // NOI18N
        btnRegRegister.setText("Register");
        btnRegRegister.setBackground(new java.awt.Color(255, 255, 255));
        btnRegRegister.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnRegRegisterActionPerformed(evt);
            }
        });

        btnRegMainMenu.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Images/MainMenuLogOut.png"))); // NOI18N
        btnRegMainMenu.setText("Go Back To Main Menu");
        btnRegMainMenu.setBackground(new java.awt.Color(255, 255, 255));
        btnRegMainMenu.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnRegMainMenuActionPerformed(evt);
            }
        });

        lbRegiFirstName.setText("First Name:");
        lbRegiFirstName.setFont(new java.awt.Font("Times New Roman", 0, 18)); // NOI18N

        lblErrRegFirstName.setFont(new java.awt.Font("Times New Roman", 0, 15)); // NOI18N
        lblErrRegFirstName.setForeground(new java.awt.Color(255, 0, 0));

        lblRegEmailAdd.setText("Email Address:");
        lblRegEmailAdd.setFont(new java.awt.Font("Times New Roman", 0, 18)); // NOI18N

        javax.swing.GroupLayout pnlRegisterLayout = new javax.swing.GroupLayout(pnlRegister);
        pnlRegister.setLayout(pnlRegisterLayout);
        pnlRegisterLayout.setHorizontalGroup(
            pnlRegisterLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(pnlRegisterLayout.createSequentialGroup()
                .addContainerGap()
                .addGroup(pnlRegisterLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(pnlRegisterLayout.createSequentialGroup()
                        .addGap(40, 40, 40)
                        .addGroup(pnlRegisterLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                            .addComponent(lblRegErrPhone, javax.swing.GroupLayout.DEFAULT_SIZE, 474, Short.MAX_VALUE)
                            .addComponent(txtRegFirstName)
                            .addComponent(lblErrRegFirstName, javax.swing.GroupLayout.DEFAULT_SIZE, 474, Short.MAX_VALUE)
                            .addComponent(lbRegSurName)
                            .addComponent(lblErrRegSurName, javax.swing.GroupLayout.DEFAULT_SIZE, 474, Short.MAX_VALUE)
                            .addComponent(lbRegiFirstName)
                            .addGroup(pnlRegisterLayout.createSequentialGroup()
                                .addGap(209, 209, 209)
                                .addComponent(lblRegister))
                            .addComponent(txtRegSurName)
                            .addComponent(txtRegEmailAdd)
                            .addComponent(lblRegEmailAdd)
                            .addComponent(lblRegErrEmailAdd, javax.swing.GroupLayout.DEFAULT_SIZE, 474, Short.MAX_VALUE)
                            .addComponent(lblRegPhone)
                            .addComponent(txtRegPhone))
                        .addGap(0, 0, Short.MAX_VALUE)
                        .addComponent(btnHelpReg))
                    .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, pnlRegisterLayout.createSequentialGroup()
                        .addComponent(btnRegMainMenu)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addComponent(btnRegRegister)
                        .addContainerGap())))
        );
        pnlRegisterLayout.setVerticalGroup(
            pnlRegisterLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, pnlRegisterLayout.createSequentialGroup()
                .addContainerGap()
                .addGroup(pnlRegisterLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(pnlRegisterLayout.createSequentialGroup()
                        .addComponent(lblRegister)
                        .addGap(14, 14, 14))
                    .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, pnlRegisterLayout.createSequentialGroup()
                        .addComponent(btnHelpReg)
                        .addGap(12, 12, 12)))
                .addComponent(lbRegiFirstName)
                .addGap(18, 18, 18)
                .addComponent(txtRegFirstName, javax.swing.GroupLayout.PREFERRED_SIZE, 40, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 18, Short.MAX_VALUE)
                .addComponent(lblErrRegFirstName, javax.swing.GroupLayout.PREFERRED_SIZE, 27, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(14, 14, 14)
                .addComponent(lbRegSurName)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(txtRegSurName, javax.swing.GroupLayout.PREFERRED_SIZE, 40, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 30, Short.MAX_VALUE)
                .addComponent(lblErrRegSurName, javax.swing.GroupLayout.PREFERRED_SIZE, 27, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(lblRegEmailAdd)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(txtRegEmailAdd, javax.swing.GroupLayout.PREFERRED_SIZE, 40, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 31, Short.MAX_VALUE)
                .addComponent(lblRegErrEmailAdd, javax.swing.GroupLayout.PREFERRED_SIZE, 27, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(lblRegPhone, javax.swing.GroupLayout.PREFERRED_SIZE, 33, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(txtRegPhone, javax.swing.GroupLayout.PREFERRED_SIZE, 40, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(28, 28, 28)
                .addComponent(lblRegErrPhone, javax.swing.GroupLayout.PREFERRED_SIZE, 27, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 75, Short.MAX_VALUE)
                .addGroup(pnlRegisterLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(btnRegRegister)
                    .addComponent(btnRegMainMenu))
                .addContainerGap())
        );

        getContentPane().add(pnlRegister, "card2");

        pnlCreateInvoice.setBackground(new java.awt.Color(255, 255, 255));
        pnlCreateInvoice.setForeground(new java.awt.Color(255, 255, 255));

        lbInvoiceHeading.setText("Create Invoice:");
        lbInvoiceHeading.setFont(new java.awt.Font("Times New Roman", 1, 18)); // NOI18N

        btnHelpCreateInv.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Images/Help.png"))); // NOI18N
        btnHelpCreateInv.setText("Help");
        btnHelpCreateInv.setBackground(new java.awt.Color(255, 255, 255));
        btnHelpCreateInv.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnHelpCreateInvActionPerformed(evt);
            }
        });

        btnMainMenuCreateInv.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Images/MainMenuLogOut.png"))); // NOI18N
        btnMainMenuCreateInv.setText("Main Menu");
        btnMainMenuCreateInv.setBackground(new java.awt.Color(255, 255, 255));
        btnMainMenuCreateInv.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnMainMenuCreateInvActionPerformed(evt);
            }
        });

        btnCreateInv.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Images/add.png"))); // NOI18N
        btnCreateInv.setText("Create Invoice");
        btnCreateInv.setBackground(new java.awt.Color(255, 255, 255));
        btnCreateInv.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnCreateInvActionPerformed(evt);
            }
        });

        lblSelectClient.setText("Select Client:");
        lblSelectClient.setFont(new java.awt.Font("Times New Roman", 0, 18)); // NOI18N

        cboClients.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "Choose a Client" }));
        cboClients.setBackground(new java.awt.Color(255, 255, 255));
        cboClients.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cboClientsActionPerformed(evt);
            }
        });

        lblErrClient.setFont(new java.awt.Font("Times New Roman", 0, 13)); // NOI18N
        lblErrClient.setForeground(new java.awt.Color(255, 0, 0));

        lblDOS.setText("Date of Session:");
        lblDOS.setFont(new java.awt.Font("Times New Roman", 0, 18)); // NOI18N

        lblErrorDurSes.setFont(new java.awt.Font("Times New Roman", 0, 13)); // NOI18N
        lblErrorDurSes.setForeground(new java.awt.Color(255, 0, 0));

        rdbIndividual.setText("Individual");
        rdbIndividual.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                rdbIndividualActionPerformed(evt);
            }
        });

        rdbGroup.setText("Group");
        rdbGroup.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                rdbGroupActionPerformed(evt);
            }
        });

        lblErrHowMany.setFont(new java.awt.Font("Times New Roman", 0, 13)); // NOI18N
        lblErrHowMany.setForeground(new java.awt.Color(255, 0, 0));

        lblHowMany.setText("How many people present?");
        lblHowMany.setFont(new java.awt.Font("Times New Roman", 0, 18)); // NOI18N

        lblAmount.setText("Amount:");
        lblAmount.setFont(new java.awt.Font("Times New Roman", 0, 18)); // NOI18N

        lblErrAmount.setFont(new java.awt.Font("Times New Roman", 0, 13)); // NOI18N
        lblErrAmount.setForeground(new java.awt.Color(255, 0, 0));

        lblGrpOrIndv1.setText("Group or Individual Session:");
        lblGrpOrIndv1.setFont(new java.awt.Font("Times New Roman", 0, 18)); // NOI18N

        lblErrGrpOrIndv1.setFont(new java.awt.Font("Times New Roman", 0, 13)); // NOI18N
        lblErrGrpOrIndv1.setForeground(new java.awt.Color(255, 0, 0));

        cbonoPeople.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "Choose How Many People", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", "21", "22", "23", "24", "25", "26", "27", "28", "29", "30", "31", "32", "33", "34", "35", "36", "37", "38", "39", "40", "41", "42", "43", "44", "45", "46", "47", "48", "49", "50", "51", "52", "53", "54", "55", "56", "57", "58", "59", "60", "61", "62", "63", "64", "65", "66", "67", "68", "69", "70", "71", "72", "73", "74", "75", "76", "77", "78", "79", "80", "81", "82", "83", "84", "85", "86", "87", "88", "89", "90", "91", "92", "93", "94", "95", "96", "97", "98", "99", "100", "101", "102", "103", "104", "105", "106", "107", "108", "109", "110", "111", "112", "113", "114", "115", "116", "117", "118", "119", "120", "121", "122", "123", "124", "125", "126", "127", "128", "129", "130", "131", "132", "133", "134", "135", "136", "137", "138", "139", "140", "141", "142", "143", "144", "145", "146", "147", "148", "149", "150", "151", "152", "153", "154", "155", "156", "157", "158", "159", "160", "161", "162", "163", "164", "165", "166", "167", "168", "169", "170", "171", "172", "173", "174", "175", "176", "177", "178", "179", "180", "181", "182", "183", "184", "185", "186", "187", "188", "189", "190", "191", "192", "193", "194", "195", "196", "197", "198", "199", "200", "201", "202", "203", "204", "205", "206", "207", "208", "209", "210", "211", "212", "213", "214", "215", "216", "217", "218", "219", "220", "221", "222", "223", "224", "225", "226", "227", "228", "229", "230", "231", "232", "233", "234", "235", "236", "237", "238", "239", "240", "241", "242", "243", "244", "245", "246", "247", "248", "249", "250", "251", "252", "253", "254", "255", "256", "257", "258", "259", "260", "261", "262", "263", "264", "265", "266", "267", "268", "269", "270", "271", "272", "273", "274", "275", "276", "277", "278", "279", "280", "281", "282", "283", "284", "285", "286", "287", "288", "289", "290", "291", "292", "293", "294", "295", "296", "297", "298", "299", "300", "301", "302", "303", "304", "305", "306", "307", "308", "309", "310", "311", "312", "313", "314", "315", "316", "317", "318", "319", "320", "321", "322", "323", "324", "325", "326", "327", "328", "329", "330", "331", "332", "333", "334", "335", "336", "337", "338", "339", "340", "341", "342", "343", "344", "345", "346", "347", "348", "349", "350", "351", "352", "353", "354", "355", "356", "357", "358", "359", "360", "361", "362", "363", "364", "365", "366", "367", "368", "369", "370", "371", "372", "373", "374", "375", "376", "377", "378", "379", "380", "381", "382", "383", "384", "385", "386", "387", "388", "389", "390", "391", "392", "393", "394", "395", "396", "397", "398", "399", "400", "401", "402", "403", "404", "405", "406", "407", "408", "409", "410", "411", "412", "413", "414", "415", "416", "417", "418", "419", "420", "421", "422", "423", "424", "425", "426", "427", "428", "429", "430", "431", "432", "433", "434", "435", "436", "437", "438", "439", "440", "441", "442", "443", "444", "445", "446", "447", "448", "449", "450", "451", "452", "453", "454", "455", "456", "457", "458", "459", "460", "461", "462", "463", "464", "465", "466", "467", "468", "469", "470", "471", "472", "473", "474", "475", "476", "477", "478", "479", "480", "481", "482", "483", "484", "485", "486", "487", "488", "489", "490", "491", "492", "493", "494", "495", "496", "497", "498", "499", "500", "501", "502", "503", "504", "505", "506", "507", "508", "509", "510", "511", "512", "513", "514", "515", "516", "517", "518", "519", "520", "521", "522", "523", "524", "525", "526", "527", "528", "529", "530", "531", "532", "533", "534", "535", "536", "537", "538", "539", "540", "541", "542", "543", "544", "545", "546", "547", "548", "549", "550", "551", "552", "553", "554", "555", "556", "557", "558", "559", "560", "561", "562", "563", "564", "565", "566", "567", "568", "569", "570", "571", "572", "573", "574", "575", "576", "577", "578", "579", "580", "581", "582", "583", "584", "585", "586", "587", "588", "589", "590", "591", "592", "593", "594", "595", "596", "597", "598", "599", "600", "601", "602", "603", "604", "605", "606", "607", "608", "609", "610", "611", "612", "613", "614", "615", "616", "617", "618", "619", "620", "621", "622", "623", "624", "625", "626", "627", "628", "629", "630", "631", "632", "633", "634", "635", "636", "637", "638", "639", "640", "641", "642", "643", "644", "645", "646", "647", "648", "649", "650", "651", "652", "653", "654", "655", "656", "657", "658", "659", "660", "661", "662", "663", "664", "665", "666", "667", "668", "669", "670", "671", "672", "673", "674", "675", "676", "677", "678", "679", "680", "681", "682", "683", "684", "685", "686", "687", "688", "689", "690", "691", "692", "693", "694", "695", "696", "697", "698", "699", "700", "701", "702", "703", "704", "705", "706", "707", "708", "709", "710", "711", "712", "713", "714", "715", "716", "717", "718", "719", "720", "721", "722", "723", "724", "725", "726", "727", "728", "729", "730", "731", "732", "733", "734", "735", "736", "737", "738", "739", "740", "741", "742", "743", "744", "745", "746", "747", "748", "749", "750", "751", "752", "753", "754", "755", "756", "757", "758", "759", "760", "761", "762", "763", "764", "765", "766", "767", "768", "769", "770", "771", "772", "773", "774", "775", "776", "777", "778", "779", "780", "781", "782", "783", "784", "785", "786", "787", "788", "789", "790", "791", "792", "793", "794", "795", "796", "797", "798", "799", "800", "801", "802", "803", "804", "805", "806", "807", "808", "809", "810", "811", "812", "813", "814", "815", "816", "817", "818", "819", "820", "821", "822", "823", "824", "825", "826", "827", "828", "829", "830", "831", "832", "833", "834", "835", "836", "837", "838", "839", "840", "841", "842", "843", "844", "845", "846", "847", "848", "849", "850", "851", "852", "853", "854", "855", "856", "857", "858", "859", "860", "861", "862", "863", "864", "865", "866", "867", "868", "869", "870", "871", "872", "873", "874", "875", "876", "877", "878", "879", "880", "881", "882", "883", "884", "885", "886", "887", "888", "889", "890", "891", "892", "893", "894", "895", "896", "897", "898", "899", "900", "901", "902", "903", "904", "905", "906", "907", "908", "909", "910", "911", "912", "913", "914", "915", "916", "917", "918", "919", "920", "921", "922", "923", "924", "925", "926", "927", "928", "929", "930", "931", "932", "933", "934", "935", "936", "937", "938", "939", "940", "941", "942", "943", "944", "945", "946", "947", "948", "949", "950", "951", "952", "953", "954", "955", "956", "957", "958", "959", "960", "961", "962", "963", "964", "965", "966", "967", "968", "969", "970", "971", "972", "973", "974", "975", "976", "977", "978", "979", "980", "981", "982", "983", "984", "985", "986", "987", "988", "989", "990", "991", "992", "993", "994", "995", "996", "997", "998", "999", "1000" }));
        cbonoPeople.setBackground(new java.awt.Color(255, 255, 255));

        lblDurOS.setText("Duration of Session(Hours):");
        lblDurOS.setFont(new java.awt.Font("Times New Roman", 0, 18)); // NOI18N

        cbodurSes.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "1", "1.5", "2.0", "2.5", "3.0", "3.5", "4.0", "4.5", "5.0", "5.5", "6.0", "6.5", "7.0", "7.5", "8.0" }));
        cbodurSes.setBackground(new java.awt.Color(255, 255, 255));

        lblErrorDOS.setFont(new java.awt.Font("Times New Roman", 0, 13)); // NOI18N
        lblErrorDOS.setForeground(new java.awt.Color(255, 0, 0));

        javax.swing.GroupLayout pnlCreateInvoiceLayout = new javax.swing.GroupLayout(pnlCreateInvoice);
        pnlCreateInvoice.setLayout(pnlCreateInvoiceLayout);
        pnlCreateInvoiceLayout.setHorizontalGroup(
            pnlCreateInvoiceLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, pnlCreateInvoiceLayout.createSequentialGroup()
                .addContainerGap()
                .addGroup(pnlCreateInvoiceLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                    .addGroup(pnlCreateInvoiceLayout.createSequentialGroup()
                        .addComponent(cboClients, javax.swing.GroupLayout.PREFERRED_SIZE, 241, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 150, Short.MAX_VALUE)
                        .addComponent(rdbIndividual)
                        .addGap(60, 60, 60)
                        .addComponent(rdbGroup))
                    .addGroup(pnlCreateInvoiceLayout.createSequentialGroup()
                        .addComponent(datePicker1, javax.swing.GroupLayout.PREFERRED_SIZE, 249, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addGroup(pnlCreateInvoiceLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(cbonoPeople, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(lblHowMany))
                        .addGap(9, 9, 9)))
                .addGap(16, 16, 16))
            .addGroup(pnlCreateInvoiceLayout.createSequentialGroup()
                .addGroup(pnlCreateInvoiceLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(pnlCreateInvoiceLayout.createSequentialGroup()
                        .addGap(241, 241, 241)
                        .addComponent(lbInvoiceHeading)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addComponent(btnHelpCreateInv))
                    .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, pnlCreateInvoiceLayout.createSequentialGroup()
                        .addContainerGap()
                        .addComponent(btnMainMenuCreateInv, javax.swing.GroupLayout.PREFERRED_SIZE, 138, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addComponent(btnCreateInv, javax.swing.GroupLayout.PREFERRED_SIZE, 165, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, pnlCreateInvoiceLayout.createSequentialGroup()
                        .addComponent(lblErrorDurSes, javax.swing.GroupLayout.PREFERRED_SIZE, 333, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addComponent(lblErrHowMany, javax.swing.GroupLayout.PREFERRED_SIZE, 217, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addGroup(pnlCreateInvoiceLayout.createSequentialGroup()
                        .addContainerGap()
                        .addComponent(lblErrClient, javax.swing.GroupLayout.DEFAULT_SIZE, 599, Short.MAX_VALUE)))
                .addContainerGap())
            .addGroup(pnlCreateInvoiceLayout.createSequentialGroup()
                .addGroup(pnlCreateInvoiceLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(lblDOS)
                    .addGroup(pnlCreateInvoiceLayout.createSequentialGroup()
                        .addContainerGap()
                        .addGroup(pnlCreateInvoiceLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(lblErrAmount, javax.swing.GroupLayout.PREFERRED_SIZE, 279, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(txtfldAmount, javax.swing.GroupLayout.PREFERRED_SIZE, 285, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(cbodurSes, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(lblDurOS)
                            .addComponent(lblAmount)
                            .addComponent(lblSelectClient)
                            .addComponent(lblErrorDOS, javax.swing.GroupLayout.PREFERRED_SIZE, 333, javax.swing.GroupLayout.PREFERRED_SIZE))))
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
            .addGroup(pnlCreateInvoiceLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, pnlCreateInvoiceLayout.createSequentialGroup()
                    .addContainerGap(385, Short.MAX_VALUE)
                    .addComponent(lblGrpOrIndv1)
                    .addGap(16, 16, 16)))
            .addGroup(pnlCreateInvoiceLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, pnlCreateInvoiceLayout.createSequentialGroup()
                    .addContainerGap(326, Short.MAX_VALUE)
                    .addComponent(lblErrGrpOrIndv1, javax.swing.GroupLayout.PREFERRED_SIZE, 279, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addContainerGap()))
        );
        pnlCreateInvoiceLayout.setVerticalGroup(
            pnlCreateInvoiceLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(pnlCreateInvoiceLayout.createSequentialGroup()
                .addContainerGap()
                .addGroup(pnlCreateInvoiceLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                    .addGroup(pnlCreateInvoiceLayout.createSequentialGroup()
                        .addGroup(pnlCreateInvoiceLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(btnHelpCreateInv)
                            .addComponent(lbInvoiceHeading))
                        .addGap(70, 70, 70)
                        .addComponent(lblSelectClient)
                        .addGap(18, 18, 18)
                        .addComponent(cboClients, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED))
                    .addGroup(pnlCreateInvoiceLayout.createSequentialGroup()
                        .addGroup(pnlCreateInvoiceLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(rdbIndividual)
                            .addComponent(rdbGroup))
                        .addGap(30, 30, 30)))
                .addGroup(pnlCreateInvoiceLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(pnlCreateInvoiceLayout.createSequentialGroup()
                        .addGap(58, 58, 58)
                        .addComponent(lblHowMany)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(cbonoPeople, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(18, 18, 18)
                        .addComponent(lblErrHowMany, javax.swing.GroupLayout.PREFERRED_SIZE, 39, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addGroup(pnlCreateInvoiceLayout.createSequentialGroup()
                        .addComponent(lblErrClient, javax.swing.GroupLayout.PREFERRED_SIZE, 24, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addComponent(lblDOS)
                        .addGap(18, 18, 18)
                        .addComponent(datePicker1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(18, 18, 18)
                        .addComponent(lblErrorDurSes, javax.swing.GroupLayout.PREFERRED_SIZE, 27, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 18, Short.MAX_VALUE)
                .addComponent(lblDurOS)
                .addGap(18, 18, 18)
                .addComponent(cbodurSes, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(18, 18, 18)
                .addComponent(lblErrorDOS, javax.swing.GroupLayout.PREFERRED_SIZE, 27, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(26, 26, 26)
                .addComponent(lblAmount)
                .addGap(18, 18, 18)
                .addComponent(txtfldAmount, javax.swing.GroupLayout.PREFERRED_SIZE, 34, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(18, 18, 18)
                .addComponent(lblErrAmount, javax.swing.GroupLayout.PREFERRED_SIZE, 27, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(60, 60, 60)
                .addGroup(pnlCreateInvoiceLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(btnMainMenuCreateInv, javax.swing.GroupLayout.PREFERRED_SIZE, 41, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(btnCreateInv, javax.swing.GroupLayout.PREFERRED_SIZE, 41, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addContainerGap())
            .addGroup(pnlCreateInvoiceLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                .addGroup(pnlCreateInvoiceLayout.createSequentialGroup()
                    .addGap(112, 112, 112)
                    .addComponent(lblGrpOrIndv1)
                    .addContainerGap(588, Short.MAX_VALUE)))
            .addGroup(pnlCreateInvoiceLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                .addGroup(pnlCreateInvoiceLayout.createSequentialGroup()
                    .addGap(172, 172, 172)
                    .addComponent(lblErrGrpOrIndv1, javax.swing.GroupLayout.PREFERRED_SIZE, 24, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addContainerGap(525, Short.MAX_VALUE)))
        );

        getContentPane().add(pnlCreateInvoice, "card2");

        pack();
    }// </editor-fold>//GEN-END:initComponents

    private void mniExitActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_mniExitActionPerformed
        String filePath="/Users/CrispyBacon/Desktop/Mumsle App/Client List.txt";
        
        try {
            // Open the file in write mode, create it if it doesn't exist
            Files.write(Path.of(filePath), new byte[0], StandardOpenOption.CREATE, StandardOpenOption.TRUNCATE_EXISTING);

            System.out.println("Text file emptied successfully.");

        } catch (FileAlreadyExistsException e) {
            System.out.println("File already exists but truncated successfully.");

        } catch (IOException e) {
            System.err.println("An error occurred while emptying the text file: " + e.getMessage());
        }


        System.exit(0);
    }//GEN-LAST:event_mniExitActionPerformed

    private void mniCreateInvoiceActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_mniCreateInvoiceActionPerformed
        lblErrHowMany.setText("");
        lblHowMany.setVisible(false);
        cbonoPeople.setVisible(false);
        pnlCreateInvoice.setVisible(true);
        ifrMainMenu.setVisible(false);
    }//GEN-LAST:event_mniCreateInvoiceActionPerformed

    private void btnHelpRegActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnHelpRegActionPerformed
        //Setting the colours of the labels
        lblErrRegFirstName.setForeground(Color.green);
        lblErrRegSurName.setForeground(Color.green);
        lblRegErrEmailAdd.setForeground(Color.green);
        lblRegErrPhone.setForeground(Color.green);

        //Setting the text of each label
        lblErrRegFirstName.setText(help.retrieveMessage("lblErrRegFirstName"));
        lblErrRegSurName.setText(help.retrieveMessage("lblErrRegSurName"));
        lblRegErrEmailAdd.setText(help.retrieveMessage("lblRegErrEmailAdd"));
        lblRegErrPhone.setText(help.retrieveMessage("lblRegErrPhone"));
    }//GEN-LAST:event_btnHelpRegActionPerformed

    private void btnRegRegisterActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnRegRegisterActionPerformed

        boolean correct=true; //To make sure that the program doesn't create an output with incorrect data entered

        //Retrieving values to be validated
        String email = txtRegEmailAdd.getText().toLowerCase();//Format check to make sure the email address does not have any capital letters
        String firstName=txtRegFirstName.getText().trim();
        String surname= txtRegSurName.getText().trim();
        String phone = txtRegPhone.getText();

        //Setting the colour of the labels to alert the user of the type of message they are recieving
        lblRegErrEmailAdd.setForeground(Color.red);
        lblErrRegSurName.setForeground(Color.red);
        lblErrRegFirstName.setForeground(Color.red);
        lblRegErrPhone.setForeground(Color.red);

        //Performing data validation checks on the data being read in
        lblRegErrEmailAdd.setText(DataValidation.checkNoSpace(email));
        lblRegErrEmailAdd.setText(DataValidation.validateEmail(email));
        lblErrRegSurName.setText(DataValidation.validateName(surname));
        lblErrRegFirstName.setText(DataValidation.validateName(firstName));
        lblRegErrPhone.setText(DataValidation.validatePhone(phone));


        //Checking to see if all data has been entered correctly
        if (!lblRegErrEmailAdd.getText().isEmpty()
            ||!lblErrRegSurName.getText().isEmpty()
            ||!lblErrRegFirstName.getText().isEmpty()
            ||!lblRegErrPhone.getText().isEmpty()
            ||!lblRegErrPhone.getText().isEmpty()) {
            correct=false;
        }

        if (correct){
            //Formatting to ensure that the names of the members start with capital letters
            firstName = firstName.substring(0, 1).toUpperCase()+firstName.substring(1);
            surname = surname.substring(0, 1).toUpperCase()+surname.substring(1);
            
            String fullName = firstName +" "+ surname;
            
            Client newClient= new Client(fullName,email,phone,"0");
            GenerateDocs.createClientDetails(newClient);
            PythonExecuter.ExecutePython("CreateClient");
            counter++;
            clients.add(newClient);
            cboClients.addItem(clients.get(counter-1).getName());

           

            //Resetting the labels and data fields to their default statuses
            txtRegPhone.setText("");
            txtRegEmailAdd.setText("");
            lblRegErrPhone.setText("");
            lblRegErrPhone.setText("");
            lblRegErrEmailAdd.setText("");
            lblErrRegSurName.setText("");
            lblErrRegFirstName.setText("");
            txtRegFirstName.setText("");
            txtRegSurName.setText("");

            //Switching screens
            ifrMainMenu.setVisible(true);
            pnlRegister.setVisible(false);
        }
    }//GEN-LAST:event_btnRegRegisterActionPerformed

    private void btnRegMainMenuActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnRegMainMenuActionPerformed
        //Resetting the labels and data fields to their default statuses
        txtRegPhone.setText("");
        txtRegEmailAdd.setText("");
        lblRegErrPhone.setText("");
        lblRegErrPhone.setText("");
        lblRegErrEmailAdd.setText("");
        lblErrRegSurName.setText("");
        lblErrRegFirstName.setText("");
        txtRegFirstName.setText("");
        txtRegSurName.setText("");

        //Switching screens
        ifrMainMenu.setVisible(true);
        pnlRegister.setVisible(false);
    }//GEN-LAST:event_btnRegMainMenuActionPerformed

    private void mniRegisterClientActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_mniRegisterClientActionPerformed
        pnlRegister.setVisible(true);
        ifrMainMenu.setVisible(false);
    }//GEN-LAST:event_mniRegisterClientActionPerformed

    private void btnHelpCreateInvActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnHelpCreateInvActionPerformed
        //Setting the colours of the labels
        lblErrClient.setForeground(Color.green);
        lblErrorDurSes.setForeground(Color.green);
        lblErrAmount.setForeground(Color.green);
        lblErrGrpOrIndv1.setForeground(Color.green);
        lblErrorDOS.setForeground(Color.green);
        


        //Setting the text of each label
        lblErrClient.setText(help.retrieveMessage("lblErrClient"));
        lblErrorDurSes.setText(help.retrieveMessage("lblErrorDOS"));
        lblErrAmount.setText(help.retrieveMessage("lblErrAmount"));
        lblErrGrpOrIndv1.setText(help.retrieveMessage("lblErrGrpOrIndv1"));
        if(rdbGroup.isSelected()){
        lblErrHowMany.setForeground(Color.green);
        lblErrHowMany.setText(help.retrieveMessage("lblErrHowMany"));
        lblErrorDOS.setText(help.retrieveMessage("lblErrorDOS"));
        lblErrorDOS.setText("ajdncsovnew");
        }
    }//GEN-LAST:event_btnHelpCreateInvActionPerformed

    private void btnMainMenuCreateInvActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnMainMenuCreateInvActionPerformed

        //Switching screens
        ifrMainMenu.setVisible(true);
        pnlCreateInvoice.setVisible(false);

        //Resetting the data fields and labels to their default values
        txtfldAmount.setText("");
        lblErrClient.setText("");
        lblErrHowMany.setText("");
        lblErrAmount.setText("");
        lblErrGrpOrIndv1.setText("");
        datePicker1.setText("");
        rdbGroup.setSelected(false);
        rdbIndividual.setSelected(false);
        lblErrorDurSes.setText("");
        cboClients.setSelectedIndex(0);
    }//GEN-LAST:event_btnMainMenuCreateInvActionPerformed

    private void btnCreateInvActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnCreateInvActionPerformed


        boolean correct=true;
        boolean singleCheck=true;
        String date = datePicker1.getDateStringOrEmptyString();
        date=date.replaceAll("-", "/");
        System.out.println(date);
        
        String amount = txtfldAmount.getText();
        amount = amount.trim();
        String client=cboClients.getSelectedItem().toString();
        lblErrGrpOrIndv1.setForeground(Color.red);
        lblErrHowMany.setForeground(Color.red);
        lblErrClient.setForeground(Color.red);
        lblErrorDurSes.setForeground(Color.red);
        lblErrAmount.setForeground(Color.red);

        
        //Validating the amount and date fields
        lblErrorDurSes.setText(DataValidation.validateDate(date));
        lblErrAmount.setText(DataValidation.validateAmount(amount));

        //Checking if the buttons are both selected
        if (!rdbIndividual.isSelected()&&!rdbGroup.isSelected()) {
            lblErrGrpOrIndv1.setText("Please select an option");
            correct=false;
            singleCheck=false;
        }
        else{
            lblErrGrpOrIndv1.setText("");
        }
        
        //Checking No.people Combo Box
        if(!singleCheck&&cbonoPeople.getSelectedItem().toString().equalsIgnoreCase("Choose How Many People")){
            lblErrHowMany.setText("Please select the number of people");
            correct = false;
        }
        else{
            lblErrHowMany.setText("");
        }
        if(rdbIndividual.isSelected()||(!rdbIndividual.isSelected()&&!rdbGroup.isSelected())){
            lblErrHowMany.setText("");
        }
        
        //Checking Client Combo Box
        if(cboClients.getSelectedItem().toString().equalsIgnoreCase("Choose a Client")){
            lblErrClient.setText("Please select the client you wish to invoice");
            correct = false;
        }
        else{
            lblErrClient.setText("");
        }
        
        String noPeople;
        if (rdbGroup.isSelected()) {
            noPeople= cbonoPeople.getSelectedItem().toString();
                
            if (noPeople.equalsIgnoreCase("")){
               lblErrHowMany.setText("Please select the number of people at the session");
               correct = false;
            }
            else{
               lblErrHowMany.setText("");
            }
        }
        else{
            noPeople = "1";
        }
        
        if (!lblErrClient.getText().isEmpty()
            ||!lblErrHowMany.getText().isEmpty()
            ||!lblErrorDurSes.getText().isEmpty()
            ||!lblErrAmount.getText().isEmpty()) {
            correct=false;
        }

        if (correct){
            
  
            // Getting Client and Changing Client invoice no
            boolean flag = false;
            int counter = -1;
            while(!flag){
                counter++;
                if(clients.get(counter).getName().equalsIgnoreCase(client)){
                    flag = true;
                }
            }
            
            clients.get(counter).incrementInvoiceNo();
            
            // Creating word doc
            GenerateDocs.createInvoiceTextFile(clients.get(counter), amount, date);
            PythonExecuter.ExecutePython("EditWordFile");
            
            
            // Emailing word doc
            GenerateDocs.createEmail(clients.get(counter),date);
            PythonExecuter.ExecutePython("EmailInvoice");
            
            //Updating Excel
            GenerateDocs.createExcelUpdate(clients.get(counter), date, noPeople, cbodurSes.getSelectedItem().toString());
            PythonExecuter.ExecutePython("EditExcelFile");
            PythonExecuter.ExecutePython("UploadExcel");
            
            

            ifrMainMenu.setVisible(true);
            pnlCreateInvoice.setVisible(false);
            txtfldAmount.setText("");
            lblErrClient.setText("");
            lblErrHowMany.setText("");
            lblErrAmount.setText("");
            datePicker1.setText("");
            rdbGroup.setEnabled(true);
            rdbGroup.setSelected(false);
            rdbIndividual.setSelected(false);
            rdbIndividual.setEnabled(true);
            lblErrorDurSes.setText("");
            cboClients.setSelectedIndex(0);
        }
    }//GEN-LAST:event_btnCreateInvActionPerformed

    private void rdbGroupActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_rdbGroupActionPerformed
        lblHowMany.setVisible(true);
        cbonoPeople.setVisible(true);
        lblErrHowMany.setVisible(true);
        rdbIndividual.setSelected(false);
    }//GEN-LAST:event_rdbGroupActionPerformed

    private void rdbIndividualActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_rdbIndividualActionPerformed
        rdbGroup.setSelected(false);
        lblHowMany.setVisible(false);
        cbonoPeople.setVisible(false);
        cbonoPeople.setSelectedIndex(0);
        lblErrHowMany.setVisible(false);
        lblErrHowMany.setText("");
    }//GEN-LAST:event_rdbIndividualActionPerformed

    private void cboClientsActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cboClientsActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_cboClientsActionPerformed

    /**
     * @param args the command line arguments
     */
    public static void main(String args[]) {
        /* Set the Nimbus look and feel */
        //<editor-fold defaultstate="collapsed" desc=" Look and feel setting code (optional) ">
        /* If Nimbus (introduced in Java SE 6) is not available, stay with the default look and feel.
         * For details see http://download.oracle.com/javase/tutorial/uiswing/lookandfeel/plaf.html 
         */
        try {
            for (javax.swing.UIManager.LookAndFeelInfo info : javax.swing.UIManager.getInstalledLookAndFeels()) {
                if ("Nimbus".equals(info.getName())) {
                    javax.swing.UIManager.setLookAndFeel(info.getClassName());
                    break;
                }
            }
        } catch (ClassNotFoundException ex) {
            java.util.logging.Logger.getLogger(GUI.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (InstantiationException ex) {
            java.util.logging.Logger.getLogger(GUI.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (IllegalAccessException ex) {
            java.util.logging.Logger.getLogger(GUI.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (javax.swing.UnsupportedLookAndFeelException ex) {
            java.util.logging.Logger.getLogger(GUI.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        }
        //</editor-fold>

        /* Create and display the form */
        java.awt.EventQueue.invokeLater(new Runnable() {
            public void run() {
                new GUI().setVisible(true);
            }
        });
    }

    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton btnCreateInv;
    private javax.swing.JButton btnHelpCreateInv;
    private javax.swing.JButton btnHelpReg;
    private javax.swing.JButton btnMainMenuCreateInv;
    private javax.swing.JButton btnRegMainMenu;
    private javax.swing.JButton btnRegRegister;
    private javax.swing.JComboBox<String> cboClients;
    private javax.swing.JComboBox<String> cbodurSes;
    private javax.swing.JComboBox<String> cbonoPeople;
    private com.github.lgooddatepicker.components.DatePicker datePicker1;
    private javax.swing.JInternalFrame ifrMainMenu;
    private javax.swing.JMenuBar jMenuBar1;
    private javax.swing.JLabel lbInvoiceHeading;
    private javax.swing.JLabel lbRegSurName;
    private javax.swing.JLabel lbRegiFirstName;
    private javax.swing.JLabel lblAmount;
    private javax.swing.JLabel lblDOS;
    private javax.swing.JLabel lblDurOS;
    private javax.swing.JLabel lblErrAmount;
    private javax.swing.JLabel lblErrClient;
    private javax.swing.JLabel lblErrGrpOrIndv1;
    private javax.swing.JLabel lblErrHowMany;
    private javax.swing.JLabel lblErrRegFirstName;
    private javax.swing.JLabel lblErrRegSurName;
    private javax.swing.JLabel lblErrorDOS;
    private javax.swing.JLabel lblErrorDurSes;
    private javax.swing.JLabel lblGrpOrIndv1;
    private javax.swing.JLabel lblHowMany;
    private javax.swing.JLabel lblMenuPic;
    private javax.swing.JLabel lblRegEmailAdd;
    private javax.swing.JLabel lblRegErrEmailAdd;
    private javax.swing.JLabel lblRegErrPhone;
    private javax.swing.JLabel lblRegPhone;
    private javax.swing.JLabel lblRegister;
    private javax.swing.JLabel lblSelectClient;
    private javax.swing.JMenuItem mniCreateInvoice;
    private javax.swing.JMenuItem mniExit;
    private javax.swing.JMenuItem mniRegisterClient;
    private javax.swing.JMenu mnuExit;
    private javax.swing.JMenu nmuClients;
    private javax.swing.JPanel pnlCreateInvoice;
    private javax.swing.JPanel pnlRegister;
    private javax.swing.JRadioButton rdbGroup;
    private javax.swing.JRadioButton rdbIndividual;
    private javax.swing.JTextField txtRegEmailAdd;
    private javax.swing.JTextField txtRegFirstName;
    private javax.swing.JTextField txtRegPhone;
    private javax.swing.JTextField txtRegSurName;
    private javax.swing.JTextField txtfldAmount;
    // End of variables declaration//GEN-END:variables
}
